machine:
  timezone:
    America/Los_Angeles
  environment:
    PYTHONPATH: /home/ubuntu/ISB-CGC-Webapp:/home/ubuntu/ISB-CGC-Webapp/lib
  python:
    version: 2.7.10
dependencies:
  override:
    - sudo -E /bin/sh ./shell/install-deps.sh
database:
  post:
    - mysql -u ubuntu -e "USE mysql; SET PASSWORD FOR 'ubuntu'@'localhost' = PASSWORD('isb')"
    - sudo -E /bin/sh ./shell/database-setup.sh
deployment:
  staging:
    branch: [master, continuous-integration]
    commands:
      - PATH=$PATH:/home/ubuntu/google-cloud-sdk/bin sudo -E /bin/sh ./shell/gcloud_authenticate.sh
      - PATH=$PATH:/home/ubuntu/google-cloud-sdk/bin sudo -E gcloud preview app deploy app.yaml --no-promote